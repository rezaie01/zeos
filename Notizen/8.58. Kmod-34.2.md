#Kmod #libkmod.so #depmod #insmod #kmod #lsmod #modinfo #modprobe #rmmod

## üõ†Ô∏è Kmod-34.2: Lernnotizen f√ºr LFS

### 1. Paketfunktion

- Enth√§lt Bibliotheken und Dienstprogramme zum **Laden und Verwalten von Kernel-Modulen**.
    
- Erm√∂glicht die dynamische Erweiterung der Kernel-Funktionalit√§t (z.B. Treiber, Dateisysteme, Netzwerkschicht-Protokolle).
    

---

### 2. Kompilierungsprozess

#### **Vorbereitung (Meson-Setup)**

- Erstellung eines separaten Build-Verzeichnisses:
    
    Bash
    
    ```
    mkdir -p build
    cd build
    ```
    
- Konfiguration mit Meson (trennt Quelle und Build):
    
    Bash
    
    ```
    meson setup --prefix=/usr \
                --buildtype=release \
                -D manpages=false
    ```
    
    - `-D manpages=false`: Deaktiviert die Generierung von Manpages, da diese ein externes Programm erfordert, das in LFS noch nicht installiert ist.
        

#### **Kompilierung und Test**

- Kompilierung (Meson verwendet Ninja):
    
    Bash
    
    ```
    ninja
    ```
    
- **Wichtiger Punkt:** Der Test-Suite wird **nicht ausgef√ºhrt**, da sie Kernel-Header (die "rohen" Header, nicht die fr√ºher installierten "bereinigten") erfordert, was √ºber den Umfang von LFS hinausgeht.
    

#### **Installation**

- Installation der gebauten Komponenten:
    
    Bash
    
    ```
    ninja install
    ```
    

---

### 3. Nach-der-Installation-Konfigurationen

- Es sind keine Konfigurationsschritte nach der Installation erforderlich.
    
- Die **`depmod`**-Funktionalit√§t wird jedoch f√ºr die Betriebsbereitschaft des Modulsystems **unmittelbar** nach der Installation des Kernels ben√∂tigt.
    

---

### 4. Essenzielle Programme und Bibliotheken

|**Programm / Bibliothek**|**Beschreibung**|**Nutzung (Fokus: System- & Netzwerk-Integration)**|
|---|---|---|
|#kmod|Hauptprogramm zur Modulverwaltung.|**Laden/Entladen von Modulen:** `kmod load <modulname>`, `kmod unload <modulname>`.<br><br>  <br><br>Die meisten anderen Programme sind Symlinks darauf.|
|#depmod|Modul-Abh√§ngigkeits-Ersteller (Symlink auf `kmod`).|Erstellt die Datei **`modules.dep`** basierend auf den in den Modulen gefundenen Symbolen.<br><br>  <br><br>**Funktion:** `depmod -a` (Scannt alle Module und erstellt die Abh√§ngigkeitsdatei). Diese Datei ist essenziell f√ºr **`modprobe`**.|
|#modprobe|Automatisches Modul-Laden (Symlink auf `kmod`).|Verwendet die von `depmod` erstellte Abh√§ngigkeitsdatei (`modules.dep`), um ein Modul **samt aller erforderlichen Abh√§ngigkeiten** automatisch zu laden.<br><br>  <br><br>**Nutzung:** `modprobe <modulname>`.<br><br>  <br><br>**Wichtig:** Das zentrale Kommando, um sicherzustellen, dass Kernel-Netzwerktreiber oder Dateisysteme korrekt geladen werden.|
|#insmod|Einfaches Modul-Laden (Symlink auf `kmod`).|Installiert ein ladbares Modul **direkt** in den laufenden Kernel. L√§dt **keine Abh√§ngigkeiten** automatisch.<br><br>  <br><br>**Nutzung:** `insmod <pfad/zum/modul.ko>`.|
|#rmmod|Modul-Entladen (Symlink auf `kmod`).|Entl√§dt ein Modul aus dem laufenden Kernel.<br><br>  <br><br>**Nutzung:** `rmmod <modulname>`.|
|#lsmod|Geladene Module auflisten (Symlink auf `kmod`).|Listet die aktuell im Kernel geladenen Module auf.<br><br>  <br><br>**Nutzung:** `lsmod` (zeigt u.a. **Gr√∂√üe** und **abh√§ngige Module**).<br><br>  <br><br>**Diagnose:** Schneller Check, ob ein ben√∂tigter Treiber (z.B. NIC-Treiber) aktiv ist.|
|#modinfo|Modul-Informationen anzeigen (Symlink auf `kmod`).|Untersucht eine Moduldatei und zeigt alle verf√ºgbaren Informationen an (z.B. **Autor, Version, Parameter**).<br><br>  <br><br>**Nutzung:** `modinfo <modulname>`.|
|#libkmod.so|Die dynamische Bibliothek.|Wird von anderen Programmen verwendet, um auf die Funktionalit√§ten zum Laden und Entladen von Kernel-Modulen zuzugreifen.|
