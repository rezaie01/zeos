#Ninja #ninja #ninja-jN #NINJAJOBS

## üõ†Ô∏è Ninja-1.13.1: Lernnotizen f√ºr LFS

### 1. Paketfunktion

- Ninja ist ein kleines Build-System.
    
- Fokus liegt auf Geschwindigkeit durch **hohe Parallelisierung**.
    

---

### 2. Kompilierungsprozess

#### **Vorbereitung und Ressourcenkontrolle (WICHTIG)**

- Ninja nutzt standardm√§√üig die Anzahl der CPU-Kerne plus zwei f√ºr parallele Prozesse.
    
- Dies kann zur **√úberhitzung der CPU** oder zu **Speichermangel** f√ºhren.
    
- Die Parallelit√§t kann direkt mit `-jN` begrenzt werden.
    
- **Optionale Konfiguration (Empfohlen f√ºr Systemintegration):** Implementierung der Umgebungsvariable `NINJAJOBS` zur persistenten Begrenzung der Parallelit√§t.
    ```
    sed -i '/int Guess/a \
    ```
    

int j = 0;

char* jobs = getenv("NINJAJOBS");

if (jobs != NULL) j = atoi(jobs);

if (j > 0) return j;' src/ninja.cc ``` * **Erkl√§rung:** Diese √Ñnderung weist `ninja` an, den Wert von `NINJAJOBS` auszulesen und zur Begrenzung der Prozesse zu verwenden, falls die Variable gesetzt ist.

#### **Kompilierung und Test**

- Kompilierung mit Python-Skript:
    ```
    python3 configure.py --bootstrap --verbose
    ```
    
    - `--bootstrap`: Erzwingt den **Neubau** von Ninja f√ºr das aktuelle System; dies dient als grundlegender Funktionstest.
        
- Tests k√∂nnen in der `chroot`-Umgebung nicht ausgef√ºhrt werden (ben√∂tigt `cmake`).
    

#### **Installation**

- Installation des Programms in den `PATH`:
    
    Bash
    
    ```
    install -vm755 ninja /usr/bin/
    ```
    
- Installation der Vervollst√§ndigungsskripte:
    ```
    install -vDm644 misc/bash-completion /usr/share/bash-completion/completions/ninja
    install -vDm644 misc/zsh-completion /usr/share/zsh/site-functions/_ninja
    ```
    

---

### 3. Nach-der-Installation-Konfigurationen

- Es sind keine Konfigurationsschritte nach der Installation erforderlich, au√üer der optionalen Quellcode-Modifikation zur `NINJAJOBS`-Erkennung (siehe Punkt 2).
    

---

### 4. Essenzielle Programme und ihre Nutzung

|Programm / Kommando|Beschreibung|Nutzung (Fokus: Systemintegration)|
|---|---|---|
|#ninja|Das Hauptprogramm (Build-System).|F√ºhrt den Build basierend auf den `build.ninja`-Dateien aus.<br><br>  <br><br>**Kernfunktion:** `ninja` (Startet den inkrementellen Bau im aktuellen Verzeichnis).|
|#ninja-jN|Option zur direkten Ressourcenkontrolle.|Beschr√§nkt die Anzahl der **gleichzeitig laufenden Prozesse** auf `N`.<br><br>  <br><br>**Nutzung:** `ninja -j4` (Begrenzt auf 4 Prozesse) ‚Äì **Wichtig** bei Systemen mit begrenzten Ressourcen.|
|#NINJAJOBS|Umgebungsvariable (falls `sed`-Patch angewendet).|**Globale Ressourcenkontrolle** f√ºr den Bau.<br><br>  <br><br>**Nutzung:** `export NINJAJOBS=4` (Setzt die Obergrenze f√ºr alle `ninja`-Aufrufe in der Shell-Sitzung, die den Patch verwenden).|
|#python3-configure.py|Build-Wrapper-Skript.|Wird verwendet, um Ninja f√ºr das **aktuelle System** zu komfigurieren und zu bauen.<br><br>  <br><br>**Nutzung:** `python3 configure.py --bootstrap`|