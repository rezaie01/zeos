#Libffi #libffi.so #FFI

## üõ†Ô∏è Libffi-3.5.2: Lernnotizen f√ºr LFS

### 1. Paketfunktion

- **Libffi** (**F**oreign **F**unction **I**nterface) ist eine Bibliothek, die eine portable, High-Level-Programmierschnittstelle f√ºr verschiedene **Aufrufkonventionen** bereitstellt1.
    
- Erm√∂glicht die **Laufzeit-Aufrufe** von Funktionen, die durch eine **Call-Interface-Beschreibung** definiert sind2.
    
- Dient als **Br√ºcke** zwischen Programmen, die in unterschiedlichen Sprachen geschrieben sind (z.B. Interpreter wie Perl oder Python und C/C++ Shared Library Subroutinen)3.
    

---

### 2. Kompilierungsprozess

#### **Besonderheit (WICHTIG)**

- Wie GMP wird Libffi mit **prozessorspezifischen Optimierungen** kompiliert4.
    
- Bei der Kompilierung f√ºr ein **anderes System** als das aktuelle muss der Wert des Parameters `--with-gcc-arch=` angepasst werden5.
    
- **Risiko:** Wird dies nicht korrekt gemacht, k√∂nnen alle Anwendungen, die mit `libffi` linken, **illegale Operationsfehler** (`Illegal Operation Errors`) ausl√∂sen6.
    
- **Alternative:** Falls kein sicherer Wert ermittelt werden kann, sollte die Option durch `--without-gcc-arch` ersetzt werden, um eine **generische** Bibliothek zu erzeugen7.
    

#### **Vorbereitung**

- Konfiguration des Pakets:
    ```
    ./configure --prefix=/usr \
                --disable-static \
                --with-gcc-arch=native
    ```
    
    - `--disable-static`: Verhindert die Installation statischer Bibliotheken.
        
    - `--with-gcc-arch=native`: Stellt sicher, dass GCC f√ºr das **aktuelle System optimiert** (optimale Leistung auf dem Host)8888.
        
        - Wenn das kompilierte Code auf ein **weniger leistungsf√§higes** Zielsystem kopiert werden soll, muss dieses System als Parameter angegeben werden9.
            

#### **Kompilierung und Test**

- Kompilierung: `make` 10
    
- Testdurchf√ºhrung: `make check` 11
    

#### **Installation**

- Installation der Bibliothek und Header-Dateien:
    ```
    make install
    ```
    

---

### 3. Nach-der-Installation-Konfigurationen

- Es sind keine Konfigurationsschritte nach der Installation erforderlich.
    
- Installierte Bibliothek: `libffi.so`.
    

---

### 4. Essenzielle Programme und Bibliotheken

|**Programm / Bibliothek**|**Beschreibung**|**Nutzung**|
|---|---|---|
|#libffi.so|Die dynamische Bibliothek von Libffi.|Enth√§lt die **Foreign Function Interface (FFI) API-Funktionen**13. Diese werden zur Laufzeit von Interpretern und Compiler-Toolchains verwendet, um **Code √ºber Sprachgrenzen** hinweg aufzurufen. F√ºr die Systemintegration ist die **korrekte Kompilierung** (siehe Punkt 2, Prozessoroptimierung) kritisch, um Systemstabilit√§t zu gew√§hrleisten.|