#e2fsprogs

### Funktion des Pakets

- Werkzeuge zur Verwaltung von ext2/ext3/ext4 Dateisystemen.
- Prüfen, reparieren, anlegen, labeln, defragmentieren, Backup/Restore kritischer FS-Daten.

---

### Kompilierungsprozess (exakt wie im Buch)

```bash
mkdir -v build
cd build
```

```bash
.. /configure -- prefix=/usr \
-- sysconfdir=/etc \
-- enable-elf-shlibs \
-- disable-libblkid \
-- disable-libuuid \
-- disable-uuidd \
-- disable-fsck
```

```bash
make
```

```bash
make check
```

```bash
make install
```

```bash
rm -fv /usr/lib/{libcom_err, libe2p,libext2fs, libss}.a
```

```bash
gunzip -v /usr/share/info/libext2fs.info.gz
install-info --dir-file=/usr/share/info/dir /usr/share/info/libext2fs.info
```

Optional docs:

```bash
makeinfo -o doc/com_err.info ../lib/et/com_err.texinfo
install -v -m644 doc/com_err.info /usr/share/info
install-info --dir-file=/usr/share/info/dir /usr/share/info/com_err.info
```

---

### Nach-der-Installation-Konfiguration

- Standardkonfiguration: /etc/mke2fs.conf.
- Entfernen unerwünschter Default-Feature (Beispiel aus Buch):

```bash
sed 's/metadata_csum_seed, //' -i /etc/mke2fs.conf
```

- /usr/lib/e2fsprogs und /usr/share/et enthalten Bibliotheken und Hilfsdateien.
- Bei Änderungen an Info-Dateien: install-info wie oben ausführen.

---

### Essenzielle Programme und Befehle (Ziel: Systemintegration, Wichtigkeit 10/10 — auswendig lernen)

- #mke2fs
    
    - Zweck: Erstellt ext2/3/4 Dateisysteme.
    - Wichtige Optionen / Beispiele:
        - mke2fs /dev/sdXN
        - mkfs.ext4 /dev/sdXN (hardlink zu mke2fs)
    - Prüfen vor Gebrauch: Partition, UUID, Label.
- #e2fsck (fsck.ext2/fsck.ext3/fsck.ext4)
    
    - Zweck: Prüft und repariert ext{2,3,4} Dateisysteme.
    - Wichtige Nutzung / Beispiele:
        - e2fsck -f /dev/sdXN — erzwinge Prüfung
        - e2fsck -y /dev/sdXN — automatisch alle Fragen mit "ja" beantworten (vorsichtig)
        - fsck.ext4 /dev/sdXN — äquivalent (hardlink)
- #tune2fs
    
    - Zweck: Anpassung von ext{2,3,4} Parameter und Features.
    - Wichtige Nutzung / Beispiele:
        - tune2fs -l /dev/sdXN — zeigt Superblock-Parameter
        - tune2fs -L label /dev/sdXN — setzt Dateisystem-Label
        - tune2fs -c 0 -i 0 /dev/sdXN — setzt Check-Interval/Count
- #resize2fs
    
    - Zweck: Vergrößern/Verkleinern ext{2,3,4} Dateisysteme.
    - Wichtige Nutzung / Beispiele:
        - resize2fs /dev/sdXN — passt FS an Partitionsgröße an
        - resize2fs /dev/sdXN 10G — setzt Dateisystem auf 10G (nur vergrößern online möglich)
- #dumpe2fs
    
    - Zweck: Zeigt Superblock und Block-Group-Infos.
    - Wichtige Nutzung (auswendig):
        - dumpe2fs /dev/sdXN
- #debugfs
    
    - Zweck: Interaktiver Dateisystem-Debugger (low-level).
    - Wichtige Nutzung (auswendig):
        - debugfs /dev/sdXN
        - debugfs -R 'stat /path/to/file' /dev/sdXN
- #e2label
    
    - Zweck: Zeigt / ändert Dateisystem-Label.
    - Wichtige Nutzung (auswendig):
        - e2label /dev/sdXN
        - e2label /dev/sdXN NEWLABEL
- #badblocks
    
    - Zweck: Suche nach fehlerhaften Blöcken auf einem Gerät.
    - Wichtige Nutzung (auswendig):
        - badblocks -v /dev/sdXN
- #filefrag
    
    - Zweck: Untersuchung Datei-Fragmentierung (bei Performance-Untersuchungen).
    - Wichtige Nutzung (auswendig):
        - filefrag datei
- #e2image / #e2undo / #e2mmpstatus / #e2scrub
    
    - Zweck: Backup kritischer FS-Daten, Undo-Log-Recovery, MMP-Status prüfen, Online-Checks.
    - Wichtige Nutzung (kenntnisbasiert):
        - e2image -p /dev/sdXN Datei — kritische Metadaten sichern
        - e2undo /pfad/zur/undo — undo-Log wiedergeben (bei Bedarf)
        - e2mmpstatus /dev/sdXN
        - e2scrub /dev/sdXN ; e2scrub_all

---

### Wichtige Bibliotheken / Pfade (kurz)

- Bibliotheken: libcom_err.so, libe2p.so, libext2fs.so, libss.so.
- Include: /usr/include/e2p, /usr/include/ext2fs, /usr/include/et.
- Programme: u.a. mke2fs, e2fsck, tune2fs, resize2fs, debugfs, dumpe2fs.
- Konfig: /etc/mke2fs.conf.
- Docs: /usr/share/et, /usr/lib/e2fsprogs.

---