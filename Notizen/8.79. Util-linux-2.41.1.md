#util-linux

### Funktion des Pakets

- Sammlung systemnaher Hilfsprogramme für Dateisysteme, Partitionen, Konsolen, Logs und Hardware-Utensilien.

---

### Kompilierungsprozess (exakt wie im Buch)

```bash
. /configure --bindir=/usr/bin \
--libdir=/usr/lib --runstatedir=/run \
--sbindir=/usr/sbin \
--disable-chfn-chsh \
--disable-login \
--disable-nologin \
--disable-su \
--disable-setpriv \
--disable-runuser \
--disable-pylibmount \
--disable-liblastlog2 \
--disable-static \
--without-python \
--without-systemd \
--without-systemdsystemunitdir \
ADJTIME_PATH=/var/lib/hwclock/adjtime \
--docdir=/usr/share/doc/util-linux-2.41.1
```

```bash
make
```

- Optional: Tests als nicht-root ausführen (Dummy /etc/fstab erforderlich):

```bash
touch /etc/fstab
chown -R tester .
su tester -c "make -k check"
```

- Hinweis: Einige Tests benötigen Kernel-Features (CONFIG_CRYPTO_USER_API_HASH, CONFIG_NETLINK_DIAG, CONFIG_SCSI_DEBUG).

```bash
make install
```

---

### Nach-der-Installation-Konfiguration

- ADJTIME_PATH legt Speicherort für hwclock adjtime fest: /var/lib/hwclock/adjtime.
- /var/lib/hwclock vorhanden halten.
- Prüfen von Kernel-Optionen bei Test- oder Laufzeitproblemen (siehe oben).
- Dokumentation: /usr/share/doc/util-linux-2.41.1

---

### Essenzielle Programme und Nutzung (Analyse Ziele: Systemintegration, Anfänger — lernen / auswendig)

- #mount
    
    - Wichtigkeit: 10/10
    - Zweck: Dateisystem einhängen, integraler Teil des Systemstarts/Recovery.
    - Kernnutzung (auswendig):
        - mount /dev/sdXN /mnt/point
        - umount /mnt/point
- #lsblk
    
    - Wichtigkeit: 10/10
    - Zweck: Übersicht über Blockgeräte / Partitionen (baumartig).
    - Kernnutzung (auswendig):
        - lsblk
        - lsblk -f (zeigt Dateisysteme/UUIDs/Labels)
- #fdisk / #sfdisk / #cfdisk / #partx
    
    - Wichtigkeit: 10/10
    - Zweck: Partitionierung und Kernel-Refresh der Partitionstabelle.
    - Kernnutzung (auswendig):
        - fdisk /dev/sdX (interaktiv)
        - sfdisk /dev/sdX (skriptbar)
        - cfdisk /dev/sdX (TUI)
        - partx -a /dev/sdX (Kernel über neue Partitionen informieren)
- #blkid / #findfs / #uuidgen / #wipefs
    
    - Wichtigkeit: 10/10
    - Zweck: Identifikation von Dateisystemen, Labels und UUIDs; Erzeugung und Entfernen von Signaturen.
    - Kernnutzung (auswendig):
        - blkid /dev/sdXN
        - findfs LABEL=labelname oder findfs UUID=uuid
        - uuidgen
        - wipefs -a /dev/sdXN
- #mkfs / #mkfs.* / #mkswap / #swapon / #swapoff
    
    - Wichtigkeit: 10/10
    - Zweck: Dateisystem anlegen und Swap einrichten/verwalten.
    - Kernnutzung (auswendig):
        - mkfs.ext4 /dev/sdXN
        - mkswap /dev/sdXY
        - swapon /dev/sdXY
        - swapoff /dev/sdXY
- #losetup
    
    - Wichtigkeit: 9/10
    - Zweck: Loop-Geräte für Image-Dateien verwalten; wichtig für Image-Mounts und Tests.
    - Kernnutzung (auswendig):
        - losetup --find --show image.iso
        - losetup -d /dev/loopX
- #findmnt
    
    - Wichtigkeit: 9/10
    - Zweck: Abfragen von Mount-Punkten, mtab und fstab in Skripten.
    - Kernnutzung (auswendig):
        - findmnt
        - findmnt /mnt/point
- #fsck
    
    - Wichtigkeit: 10/10
    - Zweck: Dateisystemprüfung und -reparatur (recovery/troubleshooting).
    - Kernnutzung (auswendig):
        - fsck /dev/sdXN
        - fsck -A (alle prüfen, vorsichtig einsetzen)
- #hwclock
    
    - Wichtigkeit: 8/10
    - Zweck: RTC lesen/setzen; NTP/Boot-Zeit-Konsistenz.
    - Kernnutzung (auswendig):
        - hwclock --show
        - hwclock --systohc
- #dmesg
    
    - Wichtigkeit: 10/10
    - Zweck: Kernel-Log abrufen; wichtig für Hardware- und Boot-Diagnose.
    - Kernnutzung (auswendig):
        - dmesg | less
        - dmesg --follow
- #logger
    
    - Wichtigkeit: 8/10
    - Zweck: Nachrichten in das System-Log schreiben (Skript- und Service-Debugging).
    - Kernnutzung (auswendig):
        - logger "Nachricht"
- #mountpoint
    
    - Wichtigkeit: 8/10
    - Zweck: Prüfen, ob ein Verzeichnis ein Mountpunkt ist (Skripte).
    - Kernnutzung (auswendig):
        - mountpoint /mnt/point
- #losetup, #blkid, #findfs kombiniert für Recovery/Chroot-Workflows (Image anhängen, UUID prüfen, mounten).
    

---

### Wichtige Bibliotheken / Pfade (kurz)

- Bibliotheken: libblkid.so, libfdisk.so, libmount.so, libsmartcols.so, libuuid.so
- Include: /usr/include/blkid, /usr/include/libfdisk, /usr/include/libmount, /usr/include/libsmartcols, /usr/include/uuid
- Dokumentation: /usr/share/doc/util-linux-2.41.1
- Systempfad adjtime: /var/lib/hwclock/adjtime

---