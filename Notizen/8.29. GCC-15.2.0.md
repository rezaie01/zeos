## üì¶ GCC (GNU Compiler Collection)

---

### 1. Paketfunktion

- **Zweck:** Enth√§lt die GNU Compiler Collection.
    
- **Hauptbestandteile:** Die C (`cc`/`gcc`) und C++ (`c++`/`g++`) Compiler.
    
- **Kernst√ºck:** Der Compiler √ºbersetzt Quellcode in Maschinencode und ist das **wichtigste Core-Tool** f√ºr den Bau des gesamten Linux-Systems.
    

---

### 2. Kompilierungsprozess

- **Vorbereitung:** Bau in einem dedizierten `build`-Verzeichnis.
    
    Bash
    
    ```
    mkdir -v build
    cd build
    ```
    
- **Konfiguration (x86_64):** Anpassung des Standardnamens f√ºr 64-Bit-Bibliotheken von "lib64" auf "lib".
    
    Bash
    
    ```
    case $(uname -m) in
    x86_64)
    sed -e/m64=/s/lib64/lib/ \
        -i.orig gcc/config/i386/t-linux64
    ;;
    esac
    ```
    
- **Wichtige `configure`-Flags:**
    
    - `LD=ld`: Stellt sicher, dass der **zuvor gebaute Linker** (`ld`) aus Binutils verwendet wird.
        
    - `--enable-languages=c,c++`: Beschr√§nkt die Sprachen auf C und C++.
        
    - `--enable-default-pie`: Aktiviert **PIE** (Position-Independent Executables) ‚Äì Erm√∂glicht das Sicherheitsfeature ASLR.
        
    - `--enable-default-ssp`: Aktiviert **SSP** (Stack Smashing Protection) ‚Äì Schutz vor Stack-Korruption.
        
    - `--disable-fixincludes`: Verhindert das Reparieren von System-Headern ‚Äì Nicht notwendig f√ºr moderne Linux-Systeme.
        
    - **Abh√§ngigkeiten:** Erfolgreicher Bau h√§ngt von `gmp`, `mpfr`, und `mpc` ab (arithmetische Bibliotheken).
        
- **Kompilierung:**
    
    Bash
    
    ```
    make
    ```
    

---

### 3. Nach-der-Installation-Konfigurationen

- **Test-Suite (Kritisch):** Laufen lassen der Test-Suite ist **wichtig** (dauert lange).
    
    - Stack-Limit erh√∂hen: `ulimit -s -H unlimited`.
        
    - Ausf√ºhrung als unprivilegierter Benutzer: `su tester -c "PATH=$PATH make -k check"`.
        
    - Zusammenfassung: `../contrib/test_summary`.
        
- **Installation:** `make install`.
    
- **Symlinks (Kritisch):** Erstellen der Symlinks f√ºr Kompatibilit√§t und FHS.
    
    - C Preprocessor (`cpp`):
        
        Bash
        
        ```
        ln -svr /usr/bin/cpp /usr/lib
        ```
        
    - LTO Plugin (Link Time Optimization):
        
        Bash
        
        ```
        ln -sfv ../../libexec/gcc/$(gcc-dumpmachine)/15.2.0/liblto_plugin.so \
            /usr/lib/bfd-plugins/
        ```
        
- **Berechtigungen:** Korrektur der Inhaberschaft der installierten Header-Dateien.
    
    Bash
    
    ```
    chown -v -R root:root \
        /usr/lib/gcc/$(gcc-dumpmachine)/15.2.0/include{,-fixed}
    ```
    
- **Sanity Checks (Kritisch):** √úberpr√ºfung der Toolchain-Funktionalit√§t.
    
    1. Testprogramm kompilieren und Linker-Informationen erfassen:
        
        Bash
        
        ```
        echo 'int main(){}' | cc -xc -v -Wl,--verbose &> dummy.log
        ```
        
    2. Pr√ºfung des dynamischen Linkers (Program Interpreter):
        
        Bash
        
        ```
        readelf -l a.out | grep ': /lib'
        ```
        
    3. Pr√ºfung der Startdateien (S?crt*.o):
        
        Bash
        
        ```
        grep -E ' /usr/lib.*/S?crt[1in].*succeeded' dummy.log
        ```
        
    4. Pr√ºfung der Header-Suchpfade:
        
        Bash
        
        ```
        grep -B4 /usr/include dummy.log
        ```
        
    5. Pr√ºfung der Linker-Suchpfade:
        
        Bash
        
        ```
        grep 'SEARCH.*/usr/lib' dummy.log | sed 's| | |g'
        ```
        
    6. Aufr√§umen: `rm -v a.out dummy.log`.
        

---

### 4. Essenzielle Programme und ihre Nutzung

| Programm                      | Kurzbeschreibung                                                     | Bedeutung f√ºr LFS / Administration                                                                                                       |
| ----------------------------- | -------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **`gcc`**                     | Der C-Compiler.                                                      | **Core-Tool:** Erstellt ausf√ºhrbare Programme.                                                                                           |
| **`g++` / `c++`**             | Der C++-Compiler.                                                    | **Core-Tool:** Erstellt C++-Programme.                                                                                                   |
| **`cpp`**                     | Der C-Pr√§prozessor.                                                  | Expandiert `include` und Makros vor der eigentlichen Kompilierung.                                                                       |
| **`gcov`**                    | Coverage Testing Tool.                                               | Wird zur **Code-Analyse** verwendet, um Optimierungspotenziale zu finden (Troubleshooting/Karriere).                                     |
| **`cc -xc -v -Wl,--verbose`** | **Kombiniertes Kommando** zur Diagnose des gesamten Build-Prozesses. | **Troubleshooting:** Zeigt die Compiler- und Linker-Suchpfade, Header und Bibliotheken. Essentiell, um Toolchain-Fehler zu lokalisieren. |
